<div class="user-details-container">



    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="user-form">

        <div class="parent">
            <h2 class="title">User Role Wise Details</h2>
        </div>

        <div class="form-row">

            <!-- USER NAME -->
            <div class="field">
                <input type="text" formControlName="username" list="partyUsersList" placeholder=" " />
                <label>User Name</label>
                <datalist id="partyUsersList">
                    <option *ngFor="let u of partyUsers" [value]="u.username"></option>
                </datalist>
            </div>

            <!-- ROOT NAME -->
            <div class="field">
                <input type="text" formControlName="rootName" list="rootList" placeholder=" " />
                <label>Root Name</label>
                <datalist id="rootList">
                    <option *ngFor="let r of roots" [value]="r.rootName"></option>
                </datalist>
            </div>

            <!-- GST -->
            <div class="field">
                <input type="text" formControlName="gstNo" placeholder=" " />
                <label>GST No</label>
            </div>

        </div>

        <div class="form-row">
            <div class="field full">
                <input type="text" formControlName="address" placeholder=" " />
                <label>Address</label>
            </div>
        </div>

        <!-- LOCATION (CUSTOM DROPDOWNS) -->
        <div class="form-row">

            <!-- STATE -->
            <div class="field custom-select">
                <div class="select-input" (click)="toggle('state')" [class.open]="open.state">
                    {{ getName(states, form.value.state) || 'Select State' }}
                </div>
                <div class="select-options" *ngIf="open.state">
                    <div class="option" *ngFor="let s of states" (click)="select('state', s.id); onStateChange()">
                        {{ s.name }}
                    </div>
                </div>
            </div>

            <!-- DISTRICT -->
            <div class="field custom-select">
                <div class="select-input" (click)="toggle('dist')" [class.open]="open.dist">
                    {{ getName(districts, form.value.dist) || 'Select District' }}
                </div>
                <div class="select-options" *ngIf="open.dist">
                    <div class="option" *ngFor="let d of districts" (click)="select('dist', d.id); onDistrictChange()">
                        {{ d.name }}
                    </div>
                </div>
            </div>

            <!-- TALUKA -->
            <div class="field custom-select">
                <div class="select-input" (click)="toggle('tq')" [class.open]="open.tq">
                    {{ getName(talukas, form.value.tq) || 'Select Taluka' }}
                </div>
                <div class="select-options" *ngIf="open.tq">
                    <div class="option" *ngFor="let t of talukas" (click)="select('tq', t.id); onTalukaChange()">
                        {{ t.name }}
                    </div>
                </div>
            </div>

            <!-- CITY -->
            <div class="field custom-select">
                <div class="select-input" (click)="toggle('city')" [class.open]="open.city">
                    {{ getName(cities, form.value.city) || 'Select City' }}
                </div>
                <div class="select-options" *ngIf="open.city">
                    <div class="option" *ngFor="let c of cities" (click)="select('city', c.id)">
                        {{ c.name }}
                    </div>
                </div>
            </div>

        </div>

        <button type="submit" class="btn-submit">
            {{ isEdit ? 'Update' : 'Submit' }}
        </button>

    </form>

    <!-- TABLE (UNCHANGED) -->
    <div class="table-wrapper" *ngIf="paginatedUsers.length">
        <div class="table-scroll" *ngIf="paginatedUsers.length">
            <table class="lead-table">
                <thead>
                    <tr>
                        <th>Sr No</th>
                        <th>User Name</th>
                        <th>Root Name</th>
                        <th>GST No</th>
                        <th>Address</th>
                        <th>State</th>
                        <th>City</th>
                        <th>Dist</th>
                        <th>Taluka</th>
                        <th>Balance</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let u of paginatedUsers; let i = index">
                        <td>{{ users.length - ((page - 1) * pageSize + i) }}</td>
                        <td>{{ u.username }}</td>
                        <td>{{ u.rootName }}</td>
                        <td>{{ u.gstNo }}</td>
                        <td>{{ u.address }}</td>
                        <td>{{ u.state }}</td>
                        <td>{{ u.city }}</td>
                        <td>{{ u.dist }}</td>
                        <td>{{ u.tq }}</td>
                        <td>{{ u.balance }}</td>
                        <td>
                            <button class="edit-btn" (click)="edit(u)">Edit</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

</div>