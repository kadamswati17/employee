<div class="party-price-container">

    <h2 class="title">Party Wise Price List</h2>

    <form [formGroup]="form" (ngSubmit)="submit()" class="price-form">

        <div class="form-row">

            <!-- PARTY -->
            <div class="field">
                <select formControlName="party">
                    <option value="" disabled>Select Party</option>
                    <option *ngFor="let p of parties" [ngValue]="p">
                        {{ p.username }}
                    </option>
                </select>
                <label>Party Name</label>
            </div>

            <!-- PRODUCT -->
            <div class="field">
                <select formControlName="product">
                    <option value="" disabled>Select Product</option>
                    <option *ngFor="let prod of products" [ngValue]="prod">
                        {{ prod.name }}
                    </option>
                </select>
                <label>Product Name</label>
            </div>

            <!-- PRICE -->
            <div class="field">
                <input type="number" formControlName="price" placeholder=" " />
                <label>Price</label>
            </div>

        </div>

        <button class="btn-submit" type="submit">
            {{ isEdit ? 'Update' : 'Submit' }}
        </button>

    </form>

    <!-- TABLE -->
    <div class="table-wrapper" *ngIf="paginatedPriceList.length > 0">
        <table>
            <thead>
                <tr>
                    <th>Sr No</th>
                    <th>Party Name</th>
                    <th>Product Name</th>
                    <th>Price</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody>
                <tr *ngFor="let item of paginatedPriceList; let i = index">
                    <!-- ✅ DESCENDING SR NO -->
                    <td>{{ priceList.length - ((page - 1) * pageSize + i) }}</td>
                    <td>{{ item.partyName }}</td>
                    <td>{{ item.productName }}</td>
                    <td>₹ {{ item.price }}</td>
                    <td>
                        <button class="btn-edit" (click)="edit(item)">Edit</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- PAGINATION -->
        <div style="margin-top:15px; text-align:center;">
            <button *ngFor="let p of [].constructor(totalPages()); let i = index" (click)="setPage(i + 1)"
                [disabled]="page === i + 1" style="margin: 0 5px; padding: 5px 10px;">
                {{ i + 1 }}
            </button>
        </div>
    </div>

</div>